
## תוכנית: הוספת שדות כרטיס אשראי באתר (PayPal Card Fields)

### מה נבנה
נוסיף אפשרות לתשלום בכרטיס אשראי ישירות באתר, ללא הפניה ל-PayPal. הלקוח יזין מספר כרטיס, תאריך תוקף וקוד CVV בטופס באתר שלך.

### איך זה עובד
PayPal מספק "Hosted Card Fields" - שדות קלט מאובטחים שמוטמעים באתר. הנתונים נשלחים ישירות לשרתי PayPal (לא עוברים דרך השרת שלך), מה שעומד בתקני אבטחה.

### שלבים

#### 1. טעינת PayPal JavaScript SDK בדף
- נטען את PayPal SDK עם תמיכה ב-Card Fields
- ה-SDK יטופל באופן דינמי כשהלקוח בוחר תשלום באשראי

#### 2. עדכון דף ההרשמה
- כשהלקוח בוחר "כרטיס אשראי", נציג שדות:
  - מספר כרטיס אשראי
  - תאריך תוקף (MM/YY)
  - קוד CVV
- השדות יהיו Hosted Fields של PayPal (מאובטחים)

#### 3. עדכון Edge Function
- נוסיף תמיכה ביצירת Order עם אפשרות Card Processing
- נוסיף Edge Function נוספת ללכידת התשלום מהשדות

#### 4. זרימת התשלום החדשה
```text
┌─────────────────────────────────────┐
│  לקוח בוחר "כרטיס אשראי"            │
└─────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────┐
│  הצגת שדות כרטיס אשראי              │
│  (PayPal Hosted Fields)             │
│  - מספר כרטיס                       │
│  - תאריך תוקף                       │
│  - CVV                              │
└─────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────┐
│  לקוח לוחץ "לתשלום"                 │
│  → נתונים נשלחים ישירות ל-PayPal    │
│  → Order נוצר ונלכד                 │
└─────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────┐
│  הצגת הודעת הצלחה                   │
└─────────────────────────────────────┘
```

### שינויים בקבצים

**Registration.tsx**
- הוספת state לניהול שדות אשראי
- טעינת PayPal SDK דינמית
- הצגת שדות Card Fields כשנבחר "כרטיס אשראי"
- לוגיקה לעיבוד תשלום ישירות מהשדות

**create-paypal-order/index.ts**
- עדכון ליצירת Order התומך ב-Card Payment

**קובץ חדש: process-card-payment/index.ts**
- Edge Function חדשה לעיבוד תשלום כרטיס אשראי

### דרישות מוקדמות חשובות
לפני ההטמעה, יש לוודא שבחשבון PayPal שלך:
1. מופעל "Advanced Credit and Debit Card Payments"
2. החשבון הוא Business (לא Personal)
3. המדינה תומכת באפשרות זו

### הערות טכניות
- השדות מאובטחים ע"י PayPal (PCI-DSS compliant)
- הנתונים לא עוברים דרך השרת שלך
- נדרש Client ID ציבורי בצד הלקוח
